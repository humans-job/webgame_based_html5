# qa

按组件分:

1. 判定线
   1. 生成动画
   2. 聚焦动画
   3. 点击动画
   4. 消失动画
2. 音键
   1. 平移动画
   2. 消失动画
      1. 不同评分下的不同消失提示动画（方案1）
3. 计分器
   1. 得分提示动画
   2. 
4. 游戏整体的界面
   1. 游戏开始动画
   2. 游戏结束动画
   3. 



## 结构

1. 曲谱文件
   1. 音符文件——表项（时间戳、所属判定线、音符类型【目前只为1，表示单点】）
   2. 判定线文件——表项（时间戳、判定线数量【判定线的存在状况】）
   
2. 曲谱生成器
   1. 读音符文件，生成对应的音符生成数据结构（将音符的信息存到对应的列表中）
   2. 读判定线文件，生成对应的判定线数据结构（将判定线的状态变化信息存到一个列表中）
   
3.  判定线控制器（判定线数据结构、状态标志、计时器（全局）、列表（size=6）判定线【活动区域、休眠区域】、列表区域分界索引，当前生效判定线）
   1. check_time()：读判定线数据结构，根据计时器判断当前判定线的状态（每帧）
   2. change_line ( int amount)：amount!=0，状态改变。amount>0，索引右移amount，amount<0，索引左移amount。根据索引位置得知活动数量，根据活动数量，修改活我的我就是那个动区域的判定线相应状态。修改状态标志。TODO:通信，通知音键控制器*6（状态标志）。
   3. check_line():持续请求鼠标位置,确定鼠标所属的判定区域所对应的判定线,播放聚焦动画.
   
4. 音键控制器*6（id、音符生成数据结构（队列）、音符活动队列、计时器（全局），当前被判定的音符信息、激活标志、位置）
   1. 收到判定线控制器通信：set_state(int flag): flag<id，非激活状态，修改激活标志，没有下一步的操作。flag>=id，激活状态，修改激活标志，修改位置。
   2. check_build():根据计时器j将音符生成队列中的音符转到活动队列，产生一个音符。
   3. check_death():计时器>判定的音符判定区间下界，则销毁该音符（自然死亡），将活动队头音符取出放入被判定音符，对计时器发送miss。
   4.  check_kill(id): 点击时间<判定的音符判定区间上界，则没有下一步操作，点击时间>判定音符判定区间上界，则则销毁该音符（被杀死），将活动队头音符取出放入被判定音符，对计时器发送时间（上下界时间，点击时间）；
   
5. 计分器(音符总数，各类情况次数，分数)

   1.count(上下界时间，点击时间):点击时间在 good 区间,则 good 情况次数+1,累加good对应分数，其余情况normal情况次数+1,累加normal对应分数。

   2. sum():计算各类成绩.

6. 判定线(id,样式)

   2.signal_ani(id),播放聚焦动画.

   3.click_ani(id)播放点击动画.

7. 音符(样式,存活时间,路程,判定区间):

   1.move_ani(存活时间,路程):播放平移动画.

   2.death_ani():播放消失动画.

   ​	



5.输入监听

​	1.actionlistener(keyboard Space) :监听space，触发时获取当前生效判定线，播放对应点击动画(id)，check a kill(id).

​	2.actionlistener(mouseloction) :监听鼠标位置.



